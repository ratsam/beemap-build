!function(){"use strict";var e;window.showProgress=function(t,i){var a=1-1e-16;1===t&&(t=a),1===i&&(i=a),e.setBuffer(t),e.set(i),e._trickle()},window.hideProgress=function(t){"undefined"!=typeof t&&t?setTimeout(function(){e.end()},t):e.end()},$(function(){e=new Mprogress({template:2,parent:"#page-progress"})})}(),function(){"use strict";var e,t,i=17;$(function(){window.showProgress(.1,0),L.Icon.Default.imagePath="images/",a();var e=o();n(),l(e)});var a=function(){$("#filters").treeview({nodeIcon:"no-icon",data:[{text:"Доступность",selectable:!1,nodes:[{text:"Доступность в %",selectable:!1,nodes:[{text:"За 3 дня"},{text:"За 30 дней"},{text:"За 60 дней"}]}]}]}),$("#filters").treeview("expandAll"),$("#filter-value").slider({id:"filter-value-slider",min:0,max:100,range:!0,value:[0,100]})},o=function(){var e="http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",t='<a href="http://openstreetmap.org" target="_blank" title="OpenStreetMap">OSM</a>',i=new L.TileLayer(e,{minZoom:4,maxZoom:16,attribution:t}),a=L.map("map",{scrollWheelZoom:!0,touchZoom:!0,layers:[i]}).setView([59.95,30.3],11);return a},n=function(){var a="http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",o='<a href="http://openstreetmap.org" target="_blank" title="OpenStreetMap">OSM</a>',n=new L.TileLayer(a,{attribution:o,minZoom:i,maxZoom:i});e=L.map("minimap",{scrollWheelZoom:!1,touchZoom:!1,zoomControl:!1,doubleClickZoom:!1,attributionControl:!1,dragging:!1,layers:[n]}),t=new L.FeatureGroup,e.addLayer(t)},r=function(a){var o=$("#object-info");o.find(".hint, .hint-image").hide();var n=o.find(".object-description");n.show(),n.find(".name").text(a.obj_name),n.find(".availability3").text(a.availability.availability_3),n.find(".availability30").text(a.availability.availability_30),n.find(".availability60").text(a.availability.availability_60),n.find(".availability3p").text(" ("+a.availability_proc.availability_3_proc+"%)"),n.find(".availability30p").text(" ("+a.availability_proc.availability_30_proc+"%)"),n.find(".availability60p").text(" ("+a.availability_proc.availability_60_proc+"%)"),t.clearLayers(),t.addLayer(s(a)),e.setView([a.coordinates.latitiude,a.coordinates.longtitude],i)},l=function(e){window.showProgress(.2,0),$.getJSON("json_objects.txt",function(t){function i(e){for(var l=e*o,c=Math.min(l+o,t.objects.length),d=function(){r(this.mapObj)},u=l;c>u;u++){var m=t.objects[u],p=s(m);p.on("click",d),p.mapObj=m,n.push(p)}var f=.5+u/t.objects.length*.5,b=.1+u/t.objects.length*.6;window.showProgress(f,b),c==t.objects.length?setTimeout(function(){a.addLayers(n),setTimeout(function(){window.showProgress(1,1),window.hideProgress(500)},300)},250):setTimeout(function(){i(e+1)},50)}window.showProgress(.5,.1);var a=L.markerClusterGroup({maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0}),o=9e3,n=[];e.addLayer(a),i(0)})},s=function(e){var t=new L.LatLng(e.coordinates.latitiude,e.coordinates.longtitude),i=L.AwesomeMarkers.icon({prefix:"fa",icon:"home",markerColor:"blue"});return L.marker(t,{title:e.obj_name,icon:i})}}();